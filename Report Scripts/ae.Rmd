---
title: "Academic Engagement Notebook"
params:
  council: West Central Council
output:
  html_document: default
  html_notebook: default
---

```{r ae_import_libaries, echo=FALSE, message=FALSE, warning=FALSE}
library(tidyverse)
library(pander)
library(ggplot2)
library(sqldf)
library(psych)
library(knitr)
library(gridExtra)
library(effsize)
library(likert)
library(getREAL)

```




```{r pre_ae&setup, echo=FALSE, warnings=FALSE, message=FALSE}
setwd("C:/Users/kevin/Dropbox/GetReal/Data/sqlite")

### Make connection with database
getRealdb<- dbConnect(SQLite(), dbname="outcome_history.sqlite")

pre_ae <- dbReadTable(getRealdb,"girl_pre_1617")

ae_history <-dbReadTable(getRealdb, "basic_view")

pre_ae_1415 <-dbReadTable(getRealdb, "girl_pre_1415")

pre_ae_1314 <-dbReadTable(getRealdb, "girl_pre2013")

pre_ae_1516 <- dbReadTable(getRealdb, "girl_pre_1516")

```
```{r pre_ae_1415, echo=FALSE}

pre_ae_1415 <- pre_ae_1415 %>%
    select(council, girlCode, ae.avg) %>% #select columns of interest
    mutate("Year" = "MY-14-15") # add time frame


high_1415 <- pre_ae_1415 %>%
    filter(ae.avg >=4.5)  #find cases above 4.5


mean(pre_ae_1415$ae.avg)

nrow(high_1415)

nrow(pre_ae_1415)

achieved_1415 <- nrow(high_1415) / nrow(pre_ae_1415)  #find percent

achieved_1415 <- round(achieved_1415*100,2) #clean up percent

achieved_1415 <- paste0(achieved_1415,"%", sep="")  # add percent sign

achieved_1415




```


```{r pre_ae_1516, echo=FALSE}

pre_ae_1516 <- pre_ae_1516 %>%
    select(council, girlCode, ae.avg) %>% #select columns of interest
    mutate("Year" = "MY-15-16") # add time frame


high_1516 <- pre_ae_1516 %>%
    filter(ae.avg >=4.5)  #find cases above 4.5


mean(pre_ae_1516$ae.avg)

nrow(high_1516)

nrow(pre_ae_1516)

achieved_1516 <- nrow(high_1516) / nrow(pre_ae_1516)  #find percent

achieved_1516 <- round(achieved_1516*100,2) #clean up percent

achieved_1516 <- paste0(achieved_1516,"%", sep="")  # add percent sign

achieved_1516




```



```{r pre_ae_1314, echo=FALSE}


pre_ae_1314 <- pre_ae_1314 %>% #start cleaning up df
    rename( council = girlScoutCouncil) %>% #rename council
    select(council, girlCode, ae_avg) %>% #select columns of interest
    mutate("Year" = "MY-13-14") # add time frame


high_1314 <- pre_ae_1314 %>%
    filter(ae_avg >=4.5)  #find cases above 4.5


achieved_1314 <- nrow(high_1314) / nrow(pre_ae_1314)  #find percent

achieved_1314 <- round(achieved_1314*100,2) #clean up percent

achieved_1314 <- paste0(achieved_1314,"%", sep="")  # add percent sign

pander(achieved_1314)  #make nice with pander

```



```{r pre_ae, echo=FALSE}
pre_ae <- pre_ae %>%
    select(council,grade, ae.avg,inProgramLastYear)

```

# Academic Engagement Outcome 

Academic Engagement questions gauge tangible behaviors that help students succeed in school. Questions that measure Academic Engagement include the following.

**Acadeimc Engagement Questions**

1.	I talk with my teachers before or after school, or during lunch about my assignments.
2.	I hand in my assignments on time
3.	I finish my homework even if it is boring
4.	If I can't understand my schoolwork at first, I keep trying until I do understand it.

## Pre Survey Analysis

```{r pre_ae_num, echo=FALSE}
pre_num <- pre_ae %>%
    filter(ae.avg >=4.5) #select records with outcome score who achieved outcome at high level


pre_ae_m <- mean(pre_ae$ae.avg)

pre_ae_m <-round(pre_ae_m,2)

pre_ae_m

```


The number of valid surveys entered is  **`r nrow(pre_ae)`**, and the number of students achieving at a high level is **`r nrow(pre_num)`**
and that equates to **`r ae_achieved_pre()`**. The average score from students is **`r pre_ae_m`**




```{r pre_ae_hist, echo=FALSE}

pre_ae_histq <- qplot(pre_ae$ae.avg, geom="histogram", main= "Pre Survey",ylim=c(0,60), bins=40, xlab="Outcome Scores") + geom_vline(xintercept = 4.5, col="red") 

pre_ae_histq

```


# Pre Survey Academic Engagement


```{r ae_histor_1, echo=FALSE}
ae_history_1 <- ae_history %>%
    select(Year, population, achieved, outcome.1, percent_achieved, mean) %>% #select variables of interest
    filter(outcome.1 =="Academic Engagement") %>% #select variable of interest
    select(Year, population, percent_achieved, mean ) # reselect variables of interest
    
    

pander(ae_history_1)
```


Cross Validation of Academic Engagment Skills

Survey results from teachers and parents also  Below are tables that provide a breakdown of questions on the pre survey from the parent and teacher surveys. 



# Pre Parent Survey





```{r parent_df_ae, echo=FALSE}

pre_parent  <- dbReadTable(getRealdb, "pre_parent_1617")

names(pre_parent)

#post_parent <- dbReadTable(getReal_2016db, "post_parent_1617")


```




```{r ae_pre_parent, echo=FALSE}

colnames(pre_parent)[16] <- "Q6"


pre_parent_tbl <- pre_parent %>%
    select(16)

#table(pre_parent_tbl)

#names(pre_parent_tbl)

pre_parent_tbl$Q6 <- factor(pre_parent_tbl$Q6, levels=c("Strongly Disagree", "Disagree", "Slightly Disagree", "Neither Agree/Disagree", "Slightly Agree", "Agree", "Strongly Agree"),ordered = TRUE)



```


```{r "ae_q5_parent", fig.height=5, fig.width=14, fig.path='Figs/', dev.args='cario-png', echo=FALSE}

pre_parent_test <- table(pre_parent_tbl) #make tbl for testing

#nrow(pre_parent_tbl)

#pander(pre_parent_test)  #test pre parent

pre_parent_tbl <- likert(pre_parent_tbl)

summary(pre_parent_tbl)

plot(pre_parent_tbl, type="heat") +ggtitle("Parent Pre Survey Question 6") + theme_dark ()

```


### Teacher Survey

```{r read_database_ae, echo=FALSE}

pre_teacher <- dbReadTable(getRealdb, "pre_teacher_1617") #read database

names(pre_teacher)

post_teacher <- dbReadTable(getRealdb, "post_teacher_1617") #read database

```






```{r  "ae_load_teacher", fig.height=2, fig.width=15, echo=FALSE}


#names(post_teacher) checked 

colnames(pre_teacher)[14] <- "Q5"
colnames(pre_teacher)[15] <- "Q6"

#nrow(post_teacher)

pre_teacher_tbl <- pre_teacher %>%
    select(14,15)

table(pre_teacher_tbl$Q5)
table(pre_teacher_tbl$Q6)




pre_teacher_tbl$Q5 <- factor(pre_teacher_tbl$Q5, levels=c("Strongly Disagree", "Disagree", "Slightly Disagree", "Neither Agree nor Disagree", "Slightly  Agree", "Agree", "Strongly Agree"),ordered = TRUE)

pre_teacher_tbl$Q6 <- factor(pre_teacher_tbl$Q6, levels=c("Strongly Disagree", "Disagree", "Slightly Disagree", "Neither Agree nor Disagree", "Slightly  Agree", "Agree", "Strongly Agree"),ordered = TRUE)






```



```{r "ae_teacher_plots",fig.height=5, fig.width=14, fig.path='Figs/', dev.args='cario-png', echo=FALSE}

pre_teacher_tbl <- likert(pre_teacher_tbl)

summary(pre_teacher_tbl)


plot(pre_teacher_tbl, type="heat") + ggtitle("Teacher Post Survey Question 5 & 6") + theme_dark ()




```

